---
layout: base
title: Poisson's Equation and Lapalce's Equation &#124; Vector Calculus
---

# Poisson's Equation and Laplace's Equation
{: .page-title}

With the understanding about how to differentiate and integrate scalar/vector fields in various types,
we can now explore differential equations that can be written in the language of vector calculus.

> *Definition.*{: .def}
> The **Poisson's equation** is of the form
>
> $$
  \nabla^2 \psi(\mathbf{x}) = \rho(\mathbf{x})
  $$
>
> and **Laplace's equation** is a special case of Poisson's equation of the form
>
> $$
  \nabla^2 \psi(\mathbf{x}) = 0
  $$

> *Proposition.*{: .prop}
> Laplace's equation is _linear_, i.e. if $\psi_1$ and $\psi_2$ are solutions,
> then $\lambda \phi_1 + \mu \psi_2$, where $\lambda$ and $\mu$ are real constants, is another solution.

> *Proposition.*{: .prop}
> The solution to the Poisson's equation is the sum of the complementary solution to the Laplace equation and a particular solution for the given source $\rho(\mathbf{x})$.

## Separable Solutions

> *Definition.*{: .def}
> The solution of Laplace's equation is **separable** if it can be written in the form
>
> $$
  \psi(u, v, w) = U(u)V(v)W(w)
  $$
>
> where $(u, v, w)$ are orthogonal curvilinear.

It means that for some functions that is not separable in Cartesian coordinates might be separable in others.
For example,

$$
f(x, y, z) = {1 \over (x^2 + y^2 + z^2)^{1 \over 2}} \quad \implies \quad f(r, \theta, \phi) = {1 \over r}
$$

becomes separable in spherical polars.

Using 2D Cartesian coodinates as example, given $\psi = X(x)Y(y)$, substituting it to the Laplace's equation we have

$$
\nabla^2 \psi = X''(x) Y(y) + X(x) Y''(y) = 0
$$

and therefore

$$
{X''(x) \over X(x)} = {Y''(y) \over Y(y)} = C
$$

When $C = 0$, then $X'\'(x) = Y'\'(y) = 0$ so

$$
X = Ax + B \qquad Y = Cy + D
$$

When $C = k^2$, then $X'\' - k^2X = 0$ and $Y'\' + k^2Y = 0$ so

$$
X = Ae^{kx} + Be^{-kx} \qquad Y = C\sin ky + D\cos ky
$$

When $C = -k^2$, then $X'\' + k^2X = 0$ and $Y'\' - k^2Y = 0$ so

$$
X = C\sin kx + D\cos kx \qquad Y = Ae^{ky} + Be^{-ky}
$$

We can see that the solutions to separable Laplace's equations tend to grow or decay smoothly in one direction while oscillating in the other.

## Isotropic Solutions

> *Proposition.*{: .prop}
> The Laplacian oeprator $\nabla^2$ is **isotropic**, meaning it has no preferred direction and unchanged by the rotation of a Cartesian coordinate system.

> *Proposition.*{: .prop}
> In 3D, the spherically symmetric solution to Laplace's equation is of the form
>
> $$
  \psi(\mathbf{x}) = \psi(r) = A - {B \over r}
  $$
>
> which has a singularity at $r = 0$ if $B \not= 0$.
>
> *Proof.*{: .prf}
>
> For a spherically symmetric solution, we can have $\theta$ and $\phi$ constant in spherical polars and therefore
>
> $$
  \begin{align*}
  \nabla^2 \psi = {1 \over r^2} { d \over dr } \left( r^2 {d\psi \over dr} \right) &= 0 \\
  {d\psi \over dr} &= {B \over r^2} \\
  \psi(r) &= A - {B \over r}
  \end{align*}
  $$

> *Proposition.*{: .prop}
> The flux of the vector field $\mathbf{F} = \nabla \psi$ out of a sphere $S$ is independent of its radius $r$.
>
> *Proof.*{: .prf}
>
> The gradient $\nabla \psi$ in spherical polars is given by
>
> $$
  \nabla \psi = \mathbf{e}_r {d\psi \over dr}
  $$
>
> and the normal of the spherical surface $S$ is $\mathbf{e}_r$.
>
> Hence, the flux of $\nabla \psi$ out of a sphere $S$ of radius $r$ is given by
>
> $$
  \begin{align*}
  \int_S \nabla \psi \cdot d\mathbf{S} &= \int_S {d\psi \over dr} (\mathbf{e}_r \cdot \mathbf{e}_r) \,dS \\
  &= \int_S {d \over dr} \left( A - {B \over r} \right) \,dS \\
  &= \int_0^\pi d\theta \int_0^{2\pi} d\phi \left({B \over r^2} \right) (r^2 \sin\theta) \\
  &= 4\pi B
  \end{align*}
  $$
>
> which is independent of the radius $r$.

It further implies a powerful theorem in physics namely the _Gauss' Law_ which states the flux is indepedent of the shape of the surface and only depends on the source in it.

> *Definition.*{: .def}
> The solution
>
> $$
  \psi_m = -{1 \over 4\pi r}
  $$
>
> is referred to as the potential of the _unit point source_, or as the **unit monopole**, or as the _fundamental solution_ of Poisson's equation in 3D.

> *Proposition.*{: .prop}
> If $\psi(\mathbf{x})$ is a solution to Laplace's equation then further solutions can be generated by differentiating with respect to Cartesian co-ordinates.
>
> *Proof.*{: .prf}
>
> Suppose that
>
> $$
  \omega(\mathbf{x}) = {\partial \psi \over \partial x_i}
  $$
>
> then
>
> $$
  \nabla^2 \omega = {\partial^2 \over \partial x_j \partial x_j} \left( {\partial \psi \over \partial x_i} \right)
  = {\partial \over \partial x_i} \left( {\partial^2 \psi \over \partial x_j \partial x_j} \right)
  = 0
  $$

> *Definition.*{: .def}
> Let $\mathbf{d}$ be a constant vector, then
>
> $$
  \psi_\mathbf{d} = - \mathbf{d} \cdot \nabla \psi_m =
  -d_i {\partial \psi_m \over \partial x_i}
  = - {d_i \over 4\pi r^2} {\partial r \over \partial x_i}
  = - {d_i \over 4\pi r^2} {x_i \over r}
  = - { \mathbf{d} \cdot \mathbf{x} \over 4\pi r^3}
  $$
>
> is a solution to Laplace's equation and is referred to as a **dipole** of strength $\mathbf{d}$.

A dipole can be viewed as being generated by two point sources that are of large but opposite strength and very close to each other.

Similarily results can be derived for the case of radial symmetry.

> *Proposition.*{: .prop}
> In 2D, the radially symmetric solution to Laplace's equation is of the form
>
> $$
  \psi = A + B \log r
  $$
>
> where $r$ is renamed from $\rho$ of cylindrical polars, and has a singularity at $r = 0$ if $B \not= 0$.
>
> *Proof.*{: .prf}
>
> In cylindrical polars, we have
>
> $$
  \begin{align*}
  \nabla^2 \psi = {1 \over r} {d \over dr} \left( r {d\psi \over dr} \right) &= 0 \\
  {d\psi \over dr} &= {B \over r} \\
  \psi &= A + B \log r
  \end{align*}
  $$

In 3D, the singularity will extend to the whole $z$-axis ($r = 0$) in cylindrical polars.

> *Proposition.*{: .prop}
> The flux of the vector field $\mathbf{F} = \nabla \psi$ out of a circle $C$ is independent of its radius $r$.
>
> *Proof.*{: .prf}
>
> The gradient $\nabla \psi$ in cylindrical polars is given by
>
> $$
  \nabla \psi = \mathbf{e}_r {d\psi \over dr}
  $$
>
> and the normal of the circular curve $C$ is $\mathbf{e}_r$.
>
> Hence, the flux of $\nabla \psi$ out of a circle $C$ of radius $r$ is given by
>
> $$
  \begin{align*}
  \int_C \nabla \psi \cdot \mathbf{n} \,ds &= \int_C {d\psi \over dr} (\mathbf{e}_r \cdot \mathbf{e}_r) \,ds \\
  &= \int_C {d \over dr} \left( A + B \log r \right) \,ds \\
  &= \int_0^{2\pi} d\phi \left({B \over r} \right) (r) \\
  &= 2\pi B
  \end{align*}
  $$
>
> which is independent of the radius $r$.

> *Definition.*{: .def}
> The solution
>
> $$
  \psi = {1 \over 2\pi} \log r
  $$
>
> is referred to as the potential of the _unit line source_ or as the _fundamental solution_ of Poisson's equation in 2D.

There is a subtle difference that for in general the rotational invariant solution decays to a constant asymptotically
except for the special case $\mathbb{R}$ and $\mathbb{R}^2$ in which the solution grows asymptotically as $r \to \infty$.

## Uniqueness Theorems

Similar to ordinary differential equations, Poissons's/Laplace's equations require boundary conditions so to solve for special solutions.
Before discussing what boundary conditions are needed for the uniqueness of solutions, we first state two theorems that will be useful later.

> *Theorem.*{: .thm}
> **[Green's First Formula]**
> Suppose $\phi$, $\psi$, $\nabla^2 \phi$ and $\nabla^2 \psi$ are defined in a region $V$ bounded by a piecewise smooth surface $S$.
> Then
>
> $$
  \int_V (\phi \nabla^2 \psi + \nabla \phi \cdot \nabla \psi) \,dV = \int_S \phi \nabla \psi \cdot d\mathbf{S} = \int_S \phi {\partial \psi \over \partial n} \,dS
  $$
>
> *Proof.*{: .prf}
>
> Let $\mathbf{F} = \phi \nabla \psi$, we have
>
> $$
  \nabla \cdot \mathbf{F} = \nabla \phi \cdot \nabla \psi + \phi \nabla^2 \psi
  $$
>
> Then the result can be derived from divergence theorem.

The Green's First Formula is analogous to integration by parts: $\int (fg'' + f'g') \,dx = [fg']$.

> *Theorem.*{: .thm}
> **[Green's Second Formula]**
> Suppose $\phi$, $\psi$, $\nabla^2 \phi$ and $\nabla^2 \psi$ are defined in a region $V$ bounded by a piecewise smooth surface $S$.
> Then
>
> $$
  \int_V (\phi \nabla^2 \psi - \psi \nabla^2 \phi) \,dV = \int_S \left( \phi {\partial \psi \over \partial n} - \psi {\partial \phi \over \partial n} \right) \,dS
  $$
>
> *Proof.*{: .prf}
>
> By Green's First Formula, by switching $\phi$ and $\psi$ we also have
>
> $$
  \int_V (\psi \nabla^2 \phi + \nabla \phi \cdot \nabla \psi) \,dV = \int_S \psi {\partial \phi \over \partial n} \,dS
  $$
>
> Then substract this from the Green's First Formula to get the result.

There is a similar result for 2D and can be proved by 2D divergence theorem.

> *Theorem.*{: .thm}
> Suppose $\phi$, $\psi$, $\nabla^2 \phi$ and $\nabla^2 \psi$ are defined on a closed surface $S$ bounded by a simple closed curve $C$.
> Then
>
> $$
  \int_S (\phi \nabla^2 \psi + \nabla \phi \cdot \nabla \psi) \,dS = \oint_C \phi (\nabla \psi \cdot \mathbf{n}) \,d\mathbf{s} = \oint_C \phi {\partial \psi \over \partial n} \,ds
  $$
>
> $$
  \int_S (\phi \nabla^2 \psi - \psi \nabla^2 \phi) \,dS = \oint_C \left( \phi {\partial \psi \over \partial n} - \psi {\partial \phi \over \partial n} \right) \,ds
  $$

Assume we know a solution exists for the B.V.P., the following are common boundary conditions to ensure uniqueness.

> *Proposition.*{: .prop}
> Suppose $\psi$ is a scalar field satisfying $\nabla^2 \psi = \rho(\mathbf{x})$ in $V$ and
>
> + **[Dirichlet Condition]**: $\psi = f(\mathbf{x})$ on $\partial V$, then $\psi$ is unique;
>
> + **[Neumann Condition]**: $d\psi / dn = \mathbf{n} \cdot \nabla \psi = g(\mathbf{x})$ on $\partial V$, then $\psi$ is unique upto a constant.
>
> *Proof.*{: .prf}
>
> Let $\psi_1$ and $\psi_2$ both satisfy the Poisson equation, then $\psi = \psi_1 - \psi_2$ also satisfies $\nabla^2 \psi = 0$ and either $\psi = 0$ or $\mathbf{n} \cdot \nabla \psi = 0$ on $\partial V$.
>
> From Green's First Formula with both scalar fields being $\psi$, we have
>
> $$
  \int_V (\psi \nabla^2 \psi + \nabla \psi \cdot \nabla \psi \,dV
  = \int_V |\nabla \psi|^2 \,dV
  = \int_{\partial V} \psi (\mathbf{n} \cdot \nabla \psi) \,dS = 0
  $$
>
> Since $\vert \nabla \psi \vert^2 \ge 0$, the integral can only vanish when $\nabla \psi = 0$ everywhere in $V$, so $\psi$ must be constant, i.e.
>
> $$
  \psi_1 = \psi_2 + c
  $$
>
> with $c = 0$ under Dirichlet condition.

Sometimes we will also require the solution to be continuous and smooth at the boundaries which provides additional information for finding the unique solution.
For example, for spherically symmetric solution, we will also require that to be non-singular at $r = 0$ and tends to $0$ when $r \to \infty$.

Existence of solutions is substantially hard to determine so is skipped here.

## Harmonic Functions

> *Definition.*{: .def}
> The function $\psi: \mathbb{R}^m \to \mathbb{R} (m = 2, 3)$ is **harmonic** iff all its seconnd-order partial derivatives exist and are continuous, and $\nabla^2 \psi = 0$.

> *Property.*{: .prop}
> **[Mean Value Property]**
> Suppose that $\psi$ is harmonic.
> The value of $\psi$ at a point is equal to the average of the values of $\psi$ on any spherical shell centred at that point, i.e.
>
> $$
  \psi(\mathbf{a}) = {1 \over 4\pi r^2} \int_{S_r} \psi(\mathbf{x}) \,dS
  $$
>
> where $S_r: \vert \mathbf{x} - \mathbf{a} \vert = r$.
>
> *Proof.*{: .prf}
>
> By divergence theorem,
>
> $$
  \int_S {\partial \psi \over \partial n} \,dS = \int_S \nabla \psi \cdot d\mathbf{S} = \int_V \nabla^2 \psi \,dV = 0
  $$
>
> Consider the function
>
> $$
  \bar{\psi}(r) = {1 \over 4\pi r^2} \int_{S_r} \psi(\mathbf{x}) \,dS = {1 \over 4\pi} \int_0^{\pi} d\theta \int_0^{2\pi} d\phi \,(\sin \theta \,\psi(r, \theta, \phi))
  $$
>
> and
>
> $$
  \begin{align*}
  {d \bar{\psi}(r) \over dr}
  &= {1 \over 4\pi} \int_0^{\pi} d\theta \int_0^{2\pi} d\phi \,\sin \theta {\partial \psi \over \partial r} \\
  &= {1 \over 4\pi r^2} \int_{S_r} {\partial \psi \over \partial n} \,dS \\
  &= 0
  \end{align*}
  $$
>
> since $\partial \psi / \partial n = \nabla \psi \cdot \mathbf{e}_r = \partial \psi / \partial r$ in spherical polars.
>
> Therefore, $\bar{\psi}(r)$ is constant and as $r \to 0$,
>
> $$
  \bar{\psi}(r) = \psi(\mathbf{a}) = {1 \over 4\pi r^2} \int_{S_r} \psi(\mathbf{x}) \,dS
  $$

> *Property.*{: .prop}
> **[Maxima and Minima]**
> Suppose that $\psi$ is harmonic in a volume $V$.
> Then $\psi$ attains its maximum and minimum values on the boundary $\partial V$, i.e. $\nabla^2$ is a smooth operator.
>
> *Proof.*{: .prf}
>
> If $\psi$ has a local maximum at $\mathbf{a}$ in $V$ then there exists $\varepsilon$ such that $\psi(\mathbf{x}) < \psi(\mathbf{a})$ for $\vert \mathbf{x} - \mathbf{a} \vert < \varepsilon$.
> However, by the mean value property, we have $\bar{\psi}(r) = \psi(\mathbf{a})$ for $0 < r < \varepsilon$.
> If all the $\psi(\mathbf{x})$ in the region is less than $\psi(\mathbf{a})$, their average can't be $\psi(\mathbf{a})$, which is a contradiction.


## References

* David Tong _Vector Calculus Lecture Notes_, 2024 - Chapter 5
* K.F. Riley _Mathematical Methods for Physicists and Engineers_, 1998 - Chapter 8
